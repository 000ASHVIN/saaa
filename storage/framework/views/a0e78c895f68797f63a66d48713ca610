<?php $__env->startSection('title', $member->first_name . ' ' . $member->last_name); ?>
<?php $__env->startSection('description', 'User Profile'); ?>

<?php $__env->startSection('css'); ?>
    <link href="/assets/admin/vendor/bootstrap-fileinput/jasny-bootstrap.min.css" rel="stylesheet" media="screen">
    <link rel="stylesheet" type="text/css" href="/assets/admin/vendor/bootstrap-datepicker/bootstrap-datepicker.min.css">
    <style>
        .daterangepicker{
            z-index:99999!important;
        }
    </style>
<?php $__env->stopSection(); ?>

<?php $__env->startSection('content'); ?>

    <div class="container-fluid container-fullw bg-white">
        <div class="row">
            <?php echo $__env->make('admin.members.includes.nav', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
            <div class="col-md-9 col-sm-9 nopadding">
                <div class="col-sm-12 col-md-12">
                    <?php echo Form::open(['method' => 'post', 'route' => ['dashboard.wallet.store', $member->id]]); ?>

                    <fieldset>
                        <legend>Load Money to wallet</legend>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group <?php if($errors->has('date')): ?> has-error <?php endif; ?>">
                                    <?php echo Form::label('date', 'Payment Date'); ?>

                                    <?php echo Form::input('text', 'date', null, ['class' => 'form-control is-date']); ?>

                                    <?php if($errors->has('date')): ?> <p class="help-block"><?php echo e($errors->first('date')); ?></p> <?php endif; ?>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group <?php if($errors->has('amount')): ?> has-error <?php endif; ?>">
                                    <?php echo Form::label('amount', 'Amount'); ?>

                                    <?php echo Form::input('text', 'amount', null, ['class' => 'form-control', 'placeholder' => 'R500.00']); ?>

                                    <?php if($errors->has('amount')): ?> <p class="help-block"><?php echo e($errors->first('amount')); ?></p> <?php endif; ?>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group <?php if($errors->has('method')): ?> has-error <?php endif; ?>">
                                    <?php echo Form::label('method', 'Deposit Type'); ?>

                                    <?php echo Form::select('method', [
                                        'eft' => 'Offline EFT Payment',
                                        'instant_eft' => 'Instant EFT',
                                        'debit' => 'Debit Order',
                                        'cc' => 'Credit Card',
                                        'cash' => 'Cash Received',
                                        'snap_scan' => 'SnapScan',
                                        'pebble' => 'Pebble',
                                        'pebble' => 'Pebble',
                                        'wallet_credit' => 'Wallet Credit',
                                    ],null, ['class' => 'form-control']); ?>

                                    <?php if($errors->has('method')): ?> <p class="help-block"><?php echo e($errors->first('method')); ?></p> <?php endif; ?>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <button type="submit" class="btn btn-o btn-primary" onclick="spin(this)";>
                                    Deposit Funds
                                </button>
                            </div>
                        </div>
                    </fieldset>
                    <?php echo Form::close(); ?>


                    <fieldset>
                        <legend>Wallet Withdrawal</legend>
                        <?php echo Form::open(['method' => 'POST', 'route' => ['dashboard.wallet.withdrawal', $member->id]]); ?>

                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group <?php if($errors->has('refund_amount')): ?> has-error <?php endif; ?>">
                                    <?php echo Form::label('refund_amount', 'Amount'); ?>

                                    <?php echo Form::input('text', 'refund_amount', null, ['class' => 'form-control', 'placeholder' => 'R100.00']); ?>

                                    <?php if($errors->has('refund_amount')): ?> <p class="help-block"><?php echo e($errors->first('refund_amount')); ?></p> <?php endif; ?>
                                </div>

                                <div class="form-group <?php if($errors->has('reason')): ?> has-error <?php endif; ?>">
                                    <?php echo Form::label('reason', 'Withdrawal Reason'); ?>

                                    <textarea name="reason" id="reason" cols="10" class="form-control" placeholder="User requested a refund"></textarea>
                                    <?php if($errors->has('reason')): ?> <p class="help-block"><?php echo e($errors->first('reason')); ?></p> <?php endif; ?>
                                </div>
                            </div>

                            <div class="col-md-12">
                                <button type="submit" class="btn btn-o btn-warning" onclick="spin(this)";>
                                    Withdrawal Funds
                                </button>
                            </div>
                        </div>
                        <?php echo Form::close(); ?>

                    </fieldset>

                    <fieldset>
                        <legend>Latest 10 Transactions</legend>
                        <table class="table table-striped">
                            <thead>
                            <th>Date</th>
                            <th>#INV</th>
                            <th>#PO</th>
                            <th>Type</th>
                            <th>Method</th>
                            <th>Category</th>
                            <th>Amount</th>
                            </thead>
                            <tbody>
                            <?php if(count($member->wallet->transactions)): ?>
                                <?php foreach($member->wallet->transactions()->orderBy('id', 'desc')->get()->take(9) as $transaction): ?>
                                    <tr class="<?php echo e($transaction->type == 'credit'? "success" : "danger"); ?>">
                                        <td><?php echo e(date_format($transaction->created_at, 'd F Y')); ?></td>
                                        <td><?php echo e($transaction->invoice_reference); ?></td>
                                        <td><?php echo e($transaction->invoice_order_refference); ?></td>
                                        <td><?php echo e(ucfirst($transaction->type)); ?></td>
                                        <td><?php echo e(ucwords(str_replace('_', ' ', $transaction->method))); ?></td>
                                        <td><?php echo e(ucfirst($transaction->category)); ?></td>
                                        <td>R <?php echo e(number_format($transaction->amount, 2)); ?></td>
                                    </tr>
                                <?php endforeach; ?>
                            <?php else: ?>
                                <tr>
                                    <td colspan="7">Your U-Wallet does not have any transactions available.</td>
                                </tr>
                            <?php endif; ?>
                            </tbody>
                        </table>
                    </fieldset>

                    <p style="text-align: center">
                        <a class="btn btn-default btn-block" href="<?php echo e(route('dashboard.wallet.export', $member->id)); ?>"><i class="fa fa-file-excel-o"></i> Export All Transactions</a>
                    </p>

                </div>
            </div>
        </div>
    </div>
<?php $__env->stopSection(); ?>

<?php $__env->startSection('scripts'); ?>
    <script src="/js/app.js"></script>
    <script src="/assets/admin/assets/js/profile.js"></script>
    <script src="/assets/admin/vendor/bootstrap-fileinput/jasny-bootstrap.js"></script>
    <script src="/assets/admin/vendor/bootstrap-datepicker/bootstrap-datepicker.min.js"></script>
    <script>
        jQuery(document).ready(function () {
            Profile.init();
        });
    </script>
    <script src="/assets/admin/assets/js/bootstrap-confirm-delete.js"></script>
    <?php echo $__env->make('admin.members.includes.spin', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
<?php $__env->stopSection(); ?>
<?php echo $__env->make('admin.layouts.master', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
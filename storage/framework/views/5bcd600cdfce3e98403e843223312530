<br>
<div class="row">
    <div class="col-md-12">
        <?php echo Form::open(['method' => 'get', 'route' => 'dashboard.events', 'id' => 'frm_upcoming_search']); ?>

        <div class="search-form">
            <?php echo Form::hidden('type', 'upcoming_events', ['id'=>'search_upcoming_event']); ?>

            <?php echo Form::hidden('upcoming_filter', $request->upcoming_filter?$request->upcoming_filter:'included', ['id'=>'hdn_upcoming_filter']); ?>

            <div class="row">
                <div class="col-md-3 col-lg-3">
                    <div class="form-group">
                        <label for="title"><strong>Event Name</strong></label>
                        <?php echo Form::input('text', 'title', $activeTab=='upcoming_events'?$request->title:null, ['class' => 'form-control event-title-filter', 'placeholder' => 'Event Name']); ?>

                    </div>
                </div>

                <div class="col-md-3 col-lg-3">
                    <div class="form-group">
                        <label for="subscription"><strong>Included in Subscription</strong></label>
                        <?php echo Form::select('subscription', ['yes' => 'Yes', 'no' => 'No'], $activeTab=='upcoming_events'?$request->subscription:null, ['class' => 'form-control', 'placeholder' => 'Included in Subscription']); ?>

                    </div>
                </div>

                <div class="col-md-3 col-lg-3">
                    <div class="form-group">
                        <label for="categories"><strong>Event Category</strong></label>
                        <?php echo Form::select('categories', $categories, $activeTab=='upcoming_events'?$request->categories:null, ['class' => 'form-control','placeholder' => 'Event Category']); ?>

                        <?php if($errors->has('categories')): ?> <p class="help-block"><?php echo e($errors->first('tags')); ?></p> <?php endif; ?>
                    </div>
                </div>

                <div class="col-md-3 col-lg-3">
                    <div class="form-group">
                        <button class="btn btn-primary search-button" onclick="search_spin(this)"><i class="fa fa-search"></i> Seach For Events</button>
                        <?php if(Request::is('filter_events')): ?>
                            <a href="<?php echo e(route('dashboard.events.index')); ?>" class="btn btn-warning"><i class="fa fa-close"></i> Clear Search</a>
                        <?php endif; ?>
                    </div>
                </div>
            </div>                                                          
        </div>
        <?php echo Form::close(); ?>


        <div class="">
            <span>Filter: </span>
            <?php echo Form::select('upcoming_filter', [
                'included'=>'Included',
                'paid'=>'Paid',
                'free'=>'Free'
            ], $request->upcoming_filter?$request->upcoming_filter:'included', ['id' => 'upcoming_filter']); ?>

        </div>

    </div>
</div>

<hr>
<div class="row">
    <div class="col-md-12">
        <?php if(count($upcomingEvents)): ?>
            <?php foreach($upcomingEvents as $event): ?>
                <div class="new-events-view event-container-box clearfix">
                    <div class="event-container-inner">
                        <div class="row">
                            <div class="col-md-7 col-lg-8">
                                <h4><?php echo e($event->name); ?></h4>
                                <h5>
                                    <?php if(count($event->presenters)): ?>
                                        <i class="fa fa-user"></i>
                                        <?php echo e(implode(', ',$event->presenters->pluck('name')->toArray()).' | '); ?>

                                    <?php endif; ?>
                                    <?php if(count($event->categories)): ?>
                                        <i class="fa fa-plus"></i>
                                        <?php echo e(implode(', ',$event->categories->pluck('title')->toArray()).' | '); ?>

                                    <?php endif; ?>
                                    <?php if(count($event->cpd_hours)): ?>
                                        <i class="fa fa-clock-o"></i>
                                        <?php echo e($event->cpd_hours); ?> Hours | 
                                    <?php endif; ?>

                                    <?php if(count($event->upcomingDate())): ?>
                                        <i class="fa fa-calendar-o"></i>
                                        <?php echo e(date_format($event->upcomingDate(), 'd F Y')); ?>

                                    <?php endif; ?>
                                    
                                </h5>
                                <?php if($currentPlanEvents->contains($event->id)): ?>
                                <h5 style="text-transform: none;"><i>Included in your Subscription</i></h5>
                                <?php else: ?>
                                <h5 style="text-transform: none;"><i>Not included in your Subscription</i></h5>
                                <?php endif; ?>
                            </div>
                            <div class="col-md-5 col-lg-4">
                                    <a href="<?php echo e(route('events.show', $event->slug)); ?>" class="btn btn-default upcoming-btn-container"></i>Read More</a>
                                    <?php if(in_array($event->id, $purchased_event_ids)): ?>
                                        <a href="#" class="btn btn-warning disabled upcoming-btn-container">Registered</a>
                                    <?php else: ?> 
                                        <a href="<?php echo e(route('events.register', $event->slug)); ?>" class="btn btn-primary upcoming-btn-container">Register Now</a>   
                                    <?php endif; ?>
                            </div>
                        </div>
                    </div>
                </div>
            <?php endforeach; ?>

        <div class="row text-center">
            <?php echo $upcomingEvents->render(); ?>

        </div>


    <?php else: ?>

        <div class="alert alert-info" style="margin-bottom: 0px">
            <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">X</span><span
                        class="sr-only">Close</span></button>
            <strong>Heads up!</strong> You have not registered for any events yet, to register for an event
            <a href="<?php echo route('events.index'); ?>">click here</a>
        </div>
    <?php endif; ?>
    </div>
</div>



<?php $__env->startSection('title', $member->first_name . ' ' . $member->last_name); ?>
<?php $__env->startSection('description', 'User Profile'); ?>

<?php $__env->startSection('css'); ?>
    <link href="/assets/admin/vendor/bootstrap-fileinput/jasny-bootstrap.min.css" rel="stylesheet" media="screen">
    <link rel="stylesheet" type="text/css" href="/assets/admin/vendor/bootstrap-datepicker/bootstrap-datepicker.min.css">
    <style>
        .daterangepicker{
            z-index:99999!important;
        }
    </style>
<?php $__env->stopSection(); ?>

<?php $__env->startSection('content'); ?>

    <div class="container-fluid container-fullw bg-white">
        <div class="row">
            <?php echo $__env->make('admin.members.includes.nav', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
            <div class="col-md-9 col-sm-9 nopadding">
                <fieldset>
                    <legend>Create subscription Invoice</legend>
                    <form action="/admin/members/invoices/create" method="POST">
                        <?php echo csrf_field(); ?>

                        <input type="hidden" name="user_id" value="<?php echo e($member->id); ?>"></input>
                        <div class="form-group">
                            <label>Subscription Plan</label>
                            <select name="plan_id" style="width: 100%!important;" class="form-control">
                                <option selected="selected" value="">Please Select...</option>
                                <?php foreach($subscription_plans as $plan): ?>
                                    <option value="<?php echo e($plan->id); ?>"><?php echo e($plan->name); ?> "R<?php echo e($plan->price); ?> / <?php echo e($plan->interval); ?>"</option>
                                <?php endforeach; ?>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Invoice Date</label>
                            <input type="text" class="form-control datepicker" name="date"></input>
                        </div>
                        <div class="form-group">
                            <input type="submit" value="Create subscription Invoice" class="btn btn-success btn-block"></input>
                        </div>
                    </form>
                </fieldset>

                <hr>

                <fieldset>
                    <legend>CREATE COURSE INVOICE</legend>
                    <form action="/admin/members/courses/invoices/create" method="POST">
                        <?php echo csrf_field(); ?>

                        <input type="hidden" name="user_id" value="<?php echo e($member->id); ?>"></input>
                        <div class="form-group<?php echo e($errors->has('course') ? ' has-error' : ''); ?>">
                            <label>Courses</label>
                            <select name="course" style="width: 100%!important;" class="form-control course-invoice">
                                <option selected="selected" value="">Please Select...</option>
                                <?php foreach($courses as $course): ?>
                                    <option value="<?php echo e($course->id); ?>" data-monthly="<?php echo e($course->monthly_enrollment_fee); ?>" data-yearly="<?php echo e($course->yearly_enrollment_fee); ?>" data-vat="<?php echo e($course->exclude_vat); ?>"><?php echo e($course->title); ?></option>
                                <?php endforeach; ?>
                            </select>
                            <small class="text-danger"><?php echo e($errors->first('course')); ?></small>
                        </div>
                        <div class="form-group<?php echo e($errors->has('enrollment_option') ? ' has-error' : ''); ?>">
                            <?php echo Form::label('enrollment_option', 'Enrollment Option'); ?>

                            <?php echo Form::select('enrollment_option', ['monthly' => 'Monthly', 'yearly' =>'Yearly'], null, ['id' => 'enrollment_option', 'class' => 'form-control course-enrollment-option', 'placeholder' => 'Please Select....']); ?>

                            <small class="text-danger"><?php echo e($errors->first('enrollment_option')); ?></small>
                        </div>
                        <div class="form-group">
                            <label>Price:</label>
                            <span class="course-price" style="font-weight: bold"></span>
                        </div>
                        <div class="form-group">
                            <label>Charge VAT:</label>
                            <span class="course-vat">
                                <span class="label label-success yes" style="display: none">Yes</span>
                                <span class="label label-info no" style="display: none">No</span>
                            </span>
                        </div>
                        <div class="form-group<?php echo e($errors->has('course') ? ' has-error' : ''); ?>">
                            <label>Invoice Date</label>
                            <input type="text" class="form-control datepicker" name="date"></input>
                            <small class="text-danger"><?php echo e($errors->first('course')); ?></small>
                        </div>
                        <div class="form-group">
                            <?php echo Form::label('description', 'Invoice Description'); ?>

                            <?php echo Form::input('text', 'description', null, ['class' => 'form-control']); ?>

                        </div>
                        <div class="form-group">
                            <input type="submit" value="Create Course Invoice" class="btn btn-success btn-block"></input>
                        </div>
                    </form>
                </fieldset>

                <hr>

                <fieldset>
                    <legend>Create custom Invoice</legend>
                    <form action="/admin/members/invoices/CombinedInvoice" method="POST">
                        <?php echo csrf_field(); ?>

                        <input type="hidden" name="user_id" value="<?php echo e($member->id); ?>"></input>

                        <div class="form-group">
                            <label>Please select Item</label>
                            <select class="form-control" name="option_id" style="padding: 0px">
                                <option selected="selected" value="">Please Select...</option>
                                <?php if(count($items)): ?>
                                    <?php foreach($items as $item): ?>
                                        <option value="<?php echo e($item->id); ?>" style="text-transform: capitalize"><?php echo e($item->name); ?></option>
                                    <?php endforeach; ?>
                                <?php endif; ?>
                            </select>
                        </div>

                        <div class="form-group">
                            <?php echo Form::label('description', 'Invoice Description'); ?>

                            <?php echo Form::input('text', 'description', null, ['class' => 'form-control', 'placeholder' => 'CPD Subscription Jan - Feb 2016', 'required' => 'required']); ?>

                        </div>

                        <div class="form-group">
                            <?php echo Form::label('price', 'Price'); ?>

                            <?php echo Form::input('text', 'price', null, ['class' => 'form-control', 'placeholder' => 'Enter Price "1600"']); ?>

                        </div>

                        <div class="form-group">
                            <?php echo Form::label('type', 'Type'); ?>

                            <?php echo Form::select('type', [
                                null => 'Please Select',
                                'subscription' => 'CPD subscription package',
                                'store' => 'Store',
                                'event' => 'Event',
                                'course' => 'Course'
                            ], null, ['class' => 'form-control']); ?>

                        </div>

                        <div class="form-group">
                            <?php echo Form::label('include_vat', 'Should this invoice charge VAT?'); ?>

                            <?php echo Form::select('include_vat', [
                                null => 'Please Select',
                                0 => 'No',
                                1 => 'Yes'
                            ], null, ['class' => 'form-control']); ?>

                        </div>

                        <div class="form-group">
                            <input type="submit" value="Create custom Invoice" class="btn btn-warning pull-info btn-block"></input>
                        </div>
                    </form>
                </fieldset>
            </div>
        </div>
    </div>
<?php $__env->stopSection(); ?>

<?php $__env->startSection('scripts'); ?>
    <script src="/js/app.js"></script>
    <script src="/assets/admin/assets/js/profile.js"></script>
    <script src="/assets/admin/vendor/bootstrap-fileinput/jasny-bootstrap.js"></script>
    <script src="/assets/admin/vendor/bootstrap-datepicker/bootstrap-datepicker.min.js"></script>
    <script>
        jQuery(document).ready(function () {
            Profile.init();
        });

        $(document).ready(function() {
            $('.course-invoice').change(function() {
                
                var vat = $(this).find(':selected').data('vat')

                if(vat == 0) {
                    $('.course-vat .yes').show()
                    $('.course-vat .no').hide()
                } else {
                    $('.course-vat .yes').hide()
                    $('.course-vat .no').show()
                }
                $('.course-price').html(0)
                $('.course-enrollment-option').val('').change()
            });
            $('.course-enrollment-option').change(function() {
                var price = 0;
                if($(this).val() == 'yearly') {
                    price = $('.course-invoice').find(':selected').data('yearly');
                    price = 'R'+price+' / Year';
                } else if($(this).val() == 'monthly') {
                    price = $('.course-invoice').find(':selected').data('monthly');
                    price = 'R'+price+' / Month';
                }
                
                $('.course-price').html(price)
            });
        });
    </script>
    <script src="/assets/admin/assets/js/bootstrap-confirm-delete.js"></script>
    <?php echo $__env->make('admin.members.includes.spin', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
<?php $__env->stopSection(); ?>
<?php echo $__env->make('admin.layouts.master', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
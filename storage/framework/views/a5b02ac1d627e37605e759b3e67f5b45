<?php $__env->startSection('title'); ?>
    <?php echo e($listing->title); ?>

<?php $__env->stopSection(); ?>

<?php $__env->startSection('intro'); ?>
<?php $__env->stopSection(); ?>

<?php $__env->startSection('breadcrumbs'); ?>
    <?php echo Breadcrumbs::render('store.show',$listing->title); ?>

<?php $__env->stopSection(); ?>

<?php $__env->startSection('styles'); ?>
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.9.4/css/bootstrap-select.min.css">
    <style>
        .dropdown-menu .inner {
            position: static !important;
            width: inherit !important;
            height: inherit !important;
            margin: 0 !important;
        }
    </style>
<?php $__env->stopSection(); ?>

<?php $__env->startSection('content'); ?>
    <section>
        <div class="container">
            <div class="row">
                <app-store-listing-product-selection :listing="<?php echo e($listing); ?>"
                                                     :discounts="<?php echo e($discounts); ?>"
                                                     :cart-items="<?php echo e($cartItems); ?>"
                                                     :selected-product-id="<?php echo e($selectedProductId); ?>"
                                                     inline-template>
                    <div class="col-lg-9 col-md-9 col-sm-9 col-lg-push-3 col-md-push-3 col-sm-push-3">
                        <div class="row">
                            <div class="col-lg-12 col-sm-12">
                                <div class="thumbnail relative margin-bottom-3">
                                    <figure data-mode="mouseover" style="position: relative; overflow: hidden;">

                                        <?php if($listing->image_url): ?>
                                            <img style="width: 102%" src="<?php echo e($listing->image_url); ?>" alt="<?php echo e($listing->title); ?>"/>
                                        <?php else: ?>
                                            <img style="width: 102%" src="/assets/frontend/images/shop/products/default.png" alt="<?php echo e($listing->title); ?>"/>
                                            <span class="image-title-shop">
                                            <p>
                                                <?php echo e($listing->title); ?>

                                                <small v-if="listing.discount > 0">[-<span
                                                            v-if="listing.discount_type == 'amount'">R</span>{{ listing.discount }}
                                                    <span v-if="listing.discount_type == 'percentage'">%</span>]
                                                </small>
                                            </p>
                                        </span>
                                        <?php endif; ?>

                                    </figure>
                                </div>
                            </div>

                            <?php if(($listing->discount) > 0): ?>
                                <div class="col-sm-12">
                                    <div class="alert alert-info text-center"
                                        style="background-color: #173175;color: white; border-style: dashed; margin-bottom: 10px; margin-top: 10px; padding: 5px;">
                                        <?php echo floatval($listing->discount); ?>% discount is applied on the following products
                                    </div>
                                </div>
                            <?php endif; ?>

                            <?php /*<?php if($globalDiscounts->sum('value') > 0 || count($listing->discounts) > 0): ?>*/ ?>
                                <?php /*<div class="col-sm-12">*/ ?>
                                    <?php /*<?php foreach($globalDiscounts as $globalDiscount): ?>*/ ?>
                                        <?php /*<div class="alert alert-info text-center"*/ ?>
                                             <?php /*style="background-color: #173175;color: white; border-style: dashed; margin-bottom: 10px; margin-top: 10px; padding: 5px;">*/ ?>
                                            <?php /*<?php echo $globalDiscount->description; ?>*/ ?>
                                        <?php /*</div>*/ ?>
                                    <?php /*<?php endforeach; ?>*/ ?>
                                    <?php /*<?php foreach($listing->discounts as $discount): ?>*/ ?>
                                        <?php /*<div class="alert alert-info text-center"*/ ?>
                                             <?php /*style="background-color: #173175;color: white; border-style: dashed; margin-bottom: 10px; margin-top: 10px; padding: 5px;">*/ ?>
                                            <?php /*<?php echo $discount->description; ?>*/ ?>
                                        <?php /*</div>*/ ?>
                                    <?php /*<?php endforeach; ?>*/ ?>
                                <?php /*</div>*/ ?>
                            <?php /*<?php endif; ?>*/ ?>

                            <div id="product-listing-selection" class="col-lg-12 col-sm-12">
                                <hr>
                                <form id="add-to-cart-form" role="form" class="clearfix form-horizontal nomargin"
                                      method="POST"
                                      action="<?php echo e(route('store.add-to-cart',$listing->id)); ?>">
                                    <?php echo e(csrf_field()); ?>

                                    <div class="row">
                                        <div class="col-md-12">
                                            <select data-container="body" data-width="100%" data-size="10"
                                                    v-model="selectedProductListing"
                                                    class="selectpicker"
                                                    name="product_listing_selected_option">
                                                <option v-if="listing.product_listings.length > 1"
                                                        value="0"
                                                        disabled="disabled" selected="selected">Select a product
                                                </option>
                                                <option v-bind:selected="listing.product_listings.length == 1"
                                                        v-for="productListing in listing.product_listings | orderBy 'product.topic'"
                                                        v-bind:value="productListing"
                                                        data-content="<div style='font-size: 16px; padding-top: 5px; padding-bottom: 5px;'>{{ productListing.optionTitle }}</div>">
                                                    {{ productListing.optionTitle }}
                                                </option>
                                                <?php /*<option v-if="listing.product_listings.length > 1"*/ ?>
                                                <?php /*value="all">All products*/ ?>
                                                <?php /*- {{ totals.price | currency 'R' }}</option>*/ ?>
                                            </select>

                                            <input type="hidden" name="product_listing_id"
                                                   value="{{ selectedProductListing.id }}">

                                        </div>
                                    </div>
                                    <?php if(count($cartItems) > 0): ?>
                                        <p v-if="selectedProductListing == 0">
                                            Select a product to see more information or checkout to complete your order.
                                        </p>
                                    <?php else: ?>
                                        <p v-if="selectedProductListing == 0">
                                            Select a product to see more information.
                                        </p>
                                    <?php endif; ?>
                                </form>
                                <div>
                                    <div v-if="selectedProductListing == 'all'">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="border-right">
                                                    <div class="col-md-6 bg-light">
                                                        <h4> {{ totals.cpd_hours }} Hour(s) CPD </h4>
                                                    </div>
                                                    <div class="col-md-6 bg-light">
                                                        <h4>Price {{ totals.discounted_price | currency 'R '}}</h4>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <hr>
                                        <div class="row">
                                            <div class="col-md-12 col-sm-12" style="margin-left: 15px;">

                                                The following {{ listing.product_listings.length }} products will
                                                be added to your cart:<br><br>
                                                <ul style="margin-bottom: 0;">
                                                    <li v-for="productListing in listing.product_listings">
                                                        <h5 style="margin-bottom: 0;">
                                                            <span>{{ productListing.detailedTitle }}</span></h5>
                                                    </li>
                                                </ul>

                                            </div>
                                        </div>
                                        <hr>
                                        <div class="row">
                                            <div class="col-sm-12"
                                                 v-for="tag in totals.tags">
                                                <div class="col-md-9">
                                                    <p>
                                                        <i class="{{ tag.icon_classes }}"></i>
                                                        <span class="center">
                                                            <strong>{{ tag.title }}</strong> <span>&ndash;</span> {{ tag.description }}
                                                        </span>
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="col-sm-12" v-if="listing.hasPhysicalProduct">
                                                <div class="col-md-12">
                                                    <p>
                                                        <i class="fa fa-truck"></i>
                                                        <strong>Delivered</strong> <span>&ndash;</span>
                                                        This is a physical product. You will be able to choose your
                                                        delivery method on checkout.
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div v-if="selectedProductListing != 0 && selectedProductListing != 'all'">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="border-right">
                                                    <div class="col-md-6 bg-light">
                                                        <h4> {{ selectedProductListing.product.cpd_hours }} Hour(s)
                                                            CPD </h4>
                                                    </div>
                                                    <div class="col-md-6 bg-light">
                                                        <h4>
                                                            {{ selectedProductListing.discountedPrice | currency 'R ' }}
                                                            <span v-if="selectedProductListing.discountedPrice < selectedProductListing.product.price"
                                                                  style="font-size: 0.7em; color: #ccc; text-decoration: line-through;">{{ selectedProductListing.product.price | currency 'R ' }}</span>
                                                        </h4>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <hr>
                                        <div class="row">
                                            <div class="col-sm-12"
                                                 v-for="tag in selectedProductListing.product.tags">
                                                <div class="col-md-12">
                                                    <p>
                                                        <i class="{{ tag.icon_classes }}"></i>
                                                        <span class="center"><strong>{{ tag.title }}</strong> <span>&ndash;</span> {{ tag.description }}</span>
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="col-sm-12" v-if="selectedProductListing.product.is_physical">
                                                <div class="col-md-12">
                                                    <p>
                                                        <i class="fa fa-truck"></i>
                                                        <strong>Delivered</strong> <span>&ndash;</span>
                                                        This is a physical product. You will be able to choose your
                                                        delivery method on checkout.
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row" style="margin-bottom: 5px;">
                                    <?php if(count($cartItems) > 0): ?>
                                        <div class="col-sm-12 text-right">
                                            <a href="<?php echo e(route('store.checkout')); ?>"
                                               class="btn btn-default noradius pull-right no-margin-top">CHECKOUT
                                                (<?php echo e($totalCartQty); ?> items in cart)</a>
                                            <div style="float: right;" v-if="selectedProductListing != 0">
                                                <button v-on:click="submitForm()"
                                                        class="btn btn-primary product-add-cart noradius">ADD TO CART
                                                </button>
                                            </div>
                                        </div>
                                    <?php else: ?>
                                        <div class="col-sm-6 col-sm-offset-6 text-right"
                                             v-if="selectedProductListing != 0">
                                            <button v-on:click="submitForm()"
                                                    class="btn btn-primary product-add-cart noradius">ADD TO CART
                                            </button>
                                        </div>
                                    <?php endif; ?>
                                </div>
                            </div>
                        </div>

                        <hr>

                        <?php if($listing->description != "" || count($listing->presenters) > 0): ?>
                            <ul id="myTab" class="nav nav-tabs nav-top-border margin-top-20" role="tablist">
                                <?php if($listing->description != ""): ?>
                                    <li role="presentation" class="active">
                                        <a href="#description" role="tab" data-toggle="tab">Description</a>
                                    </li>
                                <?php endif; ?>
                                <?php if(count($listing->presenters) > 0): ?>
                                    <li role="presentation">
                                        <a href="#reviews" role="tab" data-toggle="tab">Presenters</a>
                                    </li>
                                <?php endif; ?>
                            </ul>
                        <?php endif; ?>

                        <div class="tab-content padding-top-20">
                            <?php if($listing->description && $listing->description != ""): ?>
                                <div role="tabpanel" class="tab-pane fade in active" id="description">
                                    <?php echo $listing->description; ?>

                                </div>
                            <?php endif; ?>

                            <?php if($listing->presenters && count($listing->presenters) > 0): ?>
                                <div role="tabpanel" class="tab-pane fade" id="reviews">
                                    <div class="heading-title heading-dotted"
                                         style="margin-bottom: 10px; margin-top: 20px">
                                        <h4>PRESENTER/S:</h4>
                                    </div>
                                    <?php foreach($listing->presenters as $presenter): ?>
                                        <strong><?php echo e($presenter->name); ?></strong>
                                        <br>
                                        <?php echo $presenter->bio; ?>

                                        <br>
                                        <hr>
                                        <br>
                                    <?php endforeach; ?>
                                </div>
                                <hr class="margin-top-20 margin-bottom-80"/>
                            <?php endif; ?>
                        </div>
                        <?php if($listing->relatedListings && count($listing->relatedListings) > 0): ?>
                            <div class="col-md-12">
                                <h2 class="owl-featured"><strong>Related</strong> products:</h2>

                                <div class="owl-carousel featured nomargin owl-padding-10"
                                     data-plugin-options='{"singleItem": false, "items": "4", "stopOnHover":false, "autoPlay":4500, "autoHeight": false, "navigation": true, "pagination": false}'>

                                    <?php foreach($listing->relatedListings as $relatedListing): ?>
                                        <div class="shop-item no-margin">
                                            <div class="thumbnail">
                                                <a class="shop-item-image" href="<?php echo e(route('store.show',$relatedListing->id)); ?>">
                                                    <img class="img-responsive" src="/assets/frontend/images/shop/products/background.png" alt="<?php echo e($relatedListing->title); ?>"/>

                                            <span class="image-title-footer">
                                                <p><?php echo e($relatedListing->title); ?></p>
                                            </span>
                                                </a>
                                                <div class="shop-item-info">
                                                    <span class="label label-success"><?php echo e($relatedListing->category->title); ?></span>
                                                </div>
                                            </div>
                                        </div>
                                    <?php endforeach; ?>

                                </div>
                            </div>
                        <?php endif; ?>
                    </div>

                    <div class="row">
                        <?php echo $__env->make('store.includes.sidebar', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
                    </div>
                </app-store-listing-product-selection>
            </div>
        </div>
    </section>

<?php $__env->stopSection(); ?>
<?php $__env->startSection('scripts'); ?>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.9.4/js/bootstrap-select.min.js"></script>
<?php $__env->stopSection(); ?>
<?php echo $__env->make('store', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>